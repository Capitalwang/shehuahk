<?phpif($_POST["sqluser"]!=""){$sql_user = $_POST["sqluser"];$sql_psw = $_POST["sqlpsw"];$sql_host = $_POST["host"];//echo $sql_user.$sql_psw.$sql_host;$con=@mysql_connect($sql_host,$sql_user,$sql_psw);if($con ==true){//echo "数据库连接成功！"."</br>";$result =mysql_query("create database xr_rapnet");if($result){$sql = "create table admin(id int(5)  not null auto_increment primary key ,user text(16) CHARACTER SET gb2312 COLLATE gb2312_bin  not null,psw text(32) CHARACTER SET gb2312 COLLATE gb2312_bin  not null,redate text,reip text,redd text)";mysql_select_db("xr_rapnet");mysql_query("SET NAMES GB2312");$result = mysql_query($sql);$sql = "create table zcUser(id int (5) not null auto_increment primary key,user text(32) character set gb2312 collate gb2312_bin not null,psw  text(32) character set gb2312 collate gb2312_bin not null,jiqm text not null,redate text,reip text,redd text,bz text character set gb2312 collate gb2312_bin)";$result = mysql_query($sql);if($result){$sql="insert into admin(user,psw,redate) values('$_POST[adminUser]','".md5($_POST[adminPsw])."',curdate())";mysql_query($sql);$fp =fopen("xrconfig.txt","w+");$text = "host:".$sql_host."\r\nuser:".$sql_user."\r\npsw:".$sql_psw;fwrite($fp,$text);fclose($fp);echo "<script>alert(\"创建数据库成功\")</script>";header("location:index.php");}else{echo "新建表失败"."</br>";}}else{echo "创建数据库失败,请检查的的数据库地址、账号、密码等原因"."</br>";}//echo $result;//echo "新建数据库"."</br>";//echo "新建表"."</br>";}else{echo "数据库连接失败！请检查原因";}}?><script language="javascript">function sub(f){if(f.sqluser.value==""){alert("数据账号不能为空");return false;}if(f.adminPsw.value !=f.adminPsw1.value){alert("管理密码不一致");return false;}if(f.adminPsw.value ==""){alert("管理密码不能为空");return false;}if(f.adminUser.value ==""){alert("管理账号不能为空");return false;}}</script><title>数据库安装操作</title><center><form method="POST" onsubmit="return sub(this); "><table border=1 cellpadding=0><tr><td align="center">数据库配置</td></tr><tr><td> 数据库地址：<input type="text" name="host" value="localhost"/></td></tr><tr><td>数据库账号：<input type="text" name="sqluser" /></td></tr><tr><td>数据库密码：<input type="text" name="sqlpsw" /></td></tr><tr><td align="center">管理员配置</td></tr><tr><td>  管理 账号： <input type="text" name="adminUser" value="admin"/></td></tr><tr><td> 管理 密码： <input type="text" name="adminPsw" /></td></tr><tr><td> 确认 密码： <input type="text" name="adminPsw1" /></td></tr><tr><td align="center"><input type="submit" name="submit" value="下一步" /></td></tr></table></center>